# akros2_drive
Package to drive the AKROS2 robot

* Uses the [joy](https://github.com/adityakamath/joystick_drivers/tree/ros2/joy) node with the [teleop_twist_joy](https://github.com/ros2/teleop_twist_joy) package to publish the status of the controller's buttons/joysticks, and Twist messages based on user-defined configuration in the config directory. The configuration currently supports [PS3/Sixaxis](https://en.wikipedia.org/wiki/Sixaxis), [PS4](https://www.playstation.com/nl-nl/accessories/dualshock-4-wireless-controller/), [Stadia](https://stadia.google.com/controller/) and [8BitDo SN30 Pro](https://www.8bitdo.com/sn30-pro-g-classic-or-sn30-pro-sn/) controllers. Additionally, the config directory also provides the mappings for the [Thrustmaster USB Joystick](https://www.thrustmaster.com/nl-be/products/usb-joystick/) controller, which can be used to create mode/twist config files. Then, the ```joy_config``` launch argument needs to be updated.
* Implements the ```joy_mode_handler``` node, which subscribes to the joystick status, and publishes [Mode](https://github.com/adityakamath/akros2_msgs/blob/master/msg/Mode.msg) messages to indicate ```stop```, ```auto```, or ```teleop```.
* Implements the ```twist_mixer``` node that subscribes to the Mode messages from ```ds4_feedback```, the Twist messages from ```ds4_twist``` and Twist messages from an external autonomous node. Based on the mode, it then publishes either the Twist message from the PS4 controller, or the autonomous node, or zero values if the emergency stop is pressed.
* Both the ```joy_mode_handler``` and ```twist_mixer``` nodes are composed into a single ```drive_node``` (single-threaded) executable that is then launched from the launch file. Both nodes do retain the ability to be launched individually.

## akros2_drive_launch.py
This is the main launch file and has the following launch arguments:

* ```remote```: If False, runs all the nodes. If True, runs only the ```joy```, ```teleop_twist_joy``` and ```joy_mode_handler``` node (```twist_mixer``` is disabled). This allows the launch file to be launched from a remote device, where the ```twist_mixer``` node is not needed. (Default: ```False```)
* ```drive```: Enables/Disables the Drive nodes: ```twist_mixer``` and ```joy_mode_handler``` (Default: ```True```)
* ```twist_joy```: Enables/Disables the Joystick (and Twist) nodes: ```joy``` and ```teleop_twist_joy``` (Default: ```True```)
* ```joy_config```: Configures joystick mapping: ```ps3``` ([PS3/Sixaxis](https://en.wikipedia.org/wiki/Sixaxis)), ```ps4``` ([PS4](https://www.playstation.com/nl-nl/accessories/dualshock-4-wireless-controller/), ```stadia``` ([Stadia](https://stadia.google.com/controller/)), ```sn30pro``` ([8BitDo SN30 Pro](https://www.8bitdo.com/sn30-pro-g-classic-or-sn30-pro-sn/)) (Default: ```sn30pro```)