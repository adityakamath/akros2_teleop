# akros2_drive
Package to drive the AKROS2 robot

* Uses the [joy](https://github.com/adityakamath/joystick_drivers/tree/ros2/joy) node with the [teleop_twist_joy](https://github.com/ros2/teleop_twist_joy) package to publish the status of the controller's buttons/joysticks, and Twist messages based on user-defined configuration in the config directory. The configuration supports Stadia, PS4 and PS3/Sixaxis controllers.
* Implements the ```joy_mode_handler``` node, which subscribes to the joystick status, and publishes [Mode](https://github.com/adityakamath/akros2_msgs/blob/master/msg/Mode.msg) messages to indicate ```stop```, ```auto```, or ```teleop```. It also publishes the ```stop``` signal as a separate boolean message. This node supports Stadia, PS4 and PS3/Sixaxis controllers.
* Implements the ```twist_mixer``` node that subscribes to the Mode messages from ```ds4_feedback```, the Twist messages from ```ds4_twist``` and Twist messages from an external autonomous node. Based on the mode, it then publishes either the Twist message from the PS4 controller, or the autonomous node, or zero values if the emergency stop is pressed.
* Both the ```joy_mode_handler``` and ```twist_mixer``` nodes are composed into a single ```drive_node``` (single-threaded) executable that is then launched from the launch file. Both nodes do retain the ability to be launched individually. 
* Implements the [twist_mux](https://github.com/ros-teleop/twist_mux) package to implement a multiplexer, that switches between the Twist messages from the ```twist_mixer``` and external teleop nodes, based on a user-defined priority. Also uses the boolean message published from the ```joy_mode_handler``` node, to add a redundant e-stop functionality. This implementation is only for reference, and is currently commented out in the main drive launch file.
